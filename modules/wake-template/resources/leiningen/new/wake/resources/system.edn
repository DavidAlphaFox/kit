{
 :system/env
 #profile {:dev  :dev
           :test :test
           :prod :prod}
 {{#metrics?}}
 :metrics/prometheus
 {}{{/metrics?}}
 {{#repl?}}
 :repl/server
 {:port #long #or [#env REPL_PORT 7000]
  :host #or [#env REPL_HOST "0.0.0.0"]}{{/repl?}}
 {{#redis?}}
 :cache/redis
 {:ttl  3600
  :conn {:pool {}
         :spec {:uri #env REDIS_URI}}}{{/redis?}}

 :server/undertow
 {:port    #long #or [#env PORT 3000]
  :handler #ig/ref :handler/ring}

 :handler/ring
 {:router   #ig/ref :router/core
  :metrics  #ig/ref :metrics/prometheus
  :api-path "/api"
  }

 :reitit.routes/api
 {:base-path "/api"
  :env       #ig/ref :system/env

  :metrics   #ig/ref :metrics/prometheus
  }

 :router/routes
 {:routes #ig/refset :reitit/routes}

 :router/core
 {:routes #ig/ref :router/routes}
 {{#quartz?}}
 :cronut/scheduler
 {:schedule []}{{/quartz?}}
 {{#selmer?}}
 :templating/selmer
 {} {{/selmer?}}

  ;; sql
  ;; crux
  ;; oauth

 }